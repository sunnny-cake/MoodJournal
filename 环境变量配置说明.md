# 🔐 环境变量配置详细说明

## 📍 在哪里设置环境变量？

环境变量可以在**多个位置**设置，我推荐使用**方法1（.env文件）**，最简单且安全！

---

## 方法1：使用 .env 文件（⭐ 推荐，最简单）

### 位置：**项目文件夹内**

### 步骤：

1. **在项目根目录创建 `.env` 文件**
   - 位置：`D:\MoodJournal\.env`
   - 和 `app.py` 在同一文件夹

2. **在 `.env` 文件中写入：**
   ```
   ARK_API_KEY=你的真实API密钥
   ```
   例如：
   ```
   ARK_API_KEY=sk-1234567890abcdef
   ```

3. **安装 python-dotenv（如果还没安装）：**
   ```bash
   pip install python-dotenv
   ```

4. **完成！** 代码会自动读取这个文件

### ✅ 优点：
- ✅ 只在项目文件夹内，不影响电脑其他程序
- ✅ 不会意外提交到Git（已在.gitignore中）
- ✅ 简单直接，不需要系统设置
- ✅ 每个项目可以有不同的密钥

---

## 方法2：命令行临时设置（仅当前窗口有效）

### 位置：**你打开命令行的那个窗口**

### Windows PowerShell：
```powershell
# 打开PowerShell，cd到项目目录
cd D:\MoodJournal

# 设置环境变量（仅这个窗口有效）
$env:ARK_API_KEY="你的API密钥"

# 然后运行Streamlit
streamlit run app.py
```

### Windows CMD：
```cmd
# 打开CMD，cd到项目目录
cd D:\MoodJournal

# 设置环境变量（仅这个窗口有效）
set ARK_API_KEY=你的API密钥

# 然后运行Streamlit
streamlit run app.py
```

### ✅ 优点：
- ✅ 快速测试
- ✅ 不影响系统

### ❌ 缺点：
- ❌ 每次打开新窗口都要重新设置
- ❌ 关闭窗口就失效

---

## 方法3：系统环境变量（整个电脑）

### 位置：**Windows系统设置**

### 步骤：

1. **打开系统环境变量设置：**
   - 按 `Win + R`，输入 `sysdm.cpl`，回车
   - 或者：右键"此电脑" → 属性 → 高级系统设置 → 环境变量

2. **添加用户变量：**
   - 在"用户变量"区域点击"新建"
   - 变量名：`ARK_API_KEY`
   - 变量值：`你的API密钥`
   - 点击"确定"

3. **重启命令行/IDE**，让环境变量生效

### ✅ 优点：
- ✅ 设置一次，所有程序都能用
- ✅ 永久有效

### ❌ 缺点：
- ❌ 影响整个电脑（如果多个项目需要不同密钥会有冲突）
- ❌ 需要重启应用才能生效

---

## 方法4：在代码中直接写（不推荐）

### 位置：**app.py 代码里**

虽然可以，但**强烈不推荐**，因为：
- ❌ API密钥会暴露在代码中
- ❌ 如果提交到Git，密钥会泄露
- ❌ 不安全

---

## 🎯 我的推荐

**使用方法1（.env文件）**，因为：
1. ✅ 最简单：创建文件，写入密钥，完成
2. ✅ 最安全：不会意外泄露
3. ✅ 最灵活：每个项目独立配置

---

## 📝 快速开始（使用.env文件）

1. **在项目根目录创建 `.env` 文件**
   ```
   D:\MoodJournal\.env
   ```

2. **写入内容：**
   ```
   ARK_API_KEY=你的真实API密钥
   ```

3. **安装依赖（如果还没安装）：**
   ```bash
   pip install python-dotenv
   ```

4. **完成！** 运行 `streamlit run app.py` 即可

---

## ❓ 常见问题

### Q: 我已经设置了环境变量，但代码还是读不到？
A: 
- 检查 `.env` 文件是否在项目根目录（和app.py同一级）
- 检查是否安装了 `python-dotenv`：`pip install python-dotenv`
- 重启Streamlit应用

### Q: 我用了方法2（命令行），但关闭窗口后就不行了？
A: 这是正常的，方法2只对当前窗口有效。建议改用方法1（.env文件）

### Q: 多个项目需要不同的API密钥怎么办？
A: 使用方法1（.env文件），每个项目有自己的.env文件

### Q: .env文件会被提交到Git吗？
A: 不会，已经在.gitignore中排除了

---

## 🔍 如何验证环境变量是否设置成功？

在代码中添加测试（临时）：
```python
import os
print("API Key:", os.getenv('ARK_API_KEY'))
```

如果显示你的密钥（或至少不是None），说明设置成功！

